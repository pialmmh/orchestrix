# ============================================
# Sample App Container Configuration
# ============================================
# This is a SAMPLE showing how to build an app container
# that extends the quarkus-runner-base
#
# Copy this file and customize for your application:
#   cp sample-config.conf configs/myapp-build.conf

# ============================================
# Base Container Reference
# ============================================
# Which base container to extend from
BASE_CONTAINER="quarkus-runner-base"
BASE_VERSION="1"
BUILD_TYPE="app"  # This is an app build, not base

# ============================================
# Application Identity
# ============================================
APP_NAME="myapp"
APP_VERSION="1.0.0"
APP_DESCRIPTION="My Quarkus Application"

# Where is your JAR file?
APP_JAR_PATH="/path/to/myapp/target/myapp-runner.jar"
# Or for native executable:
# APP_NATIVE_PATH="/path/to/myapp/target/myapp-runner"
# PACKAGE_TYPE="native"

# ============================================
# Storage (MANDATORY - inherits BTRFS from base)
# ============================================
STORAGE_LOCATION_ID="btrfs_ssd_main"
STORAGE_QUOTA_SIZE="5G"        # App-specific quota
STORAGE_ROTATION_THRESHOLD="80"

# ============================================
# Memory & CPU (App-specific sizing)
# ============================================
MEMORY_LIMIT="1GB"             # Override base default
CPU_LIMIT="1"

# JVM heap auto-calculated as 75% of MEMORY_LIMIT
# Or specify manually:
# JVM_MAX_HEAP="768m"

# ============================================
# Application Runtime
# ============================================
QUARKUS_PROFILE="prod"         # dev, test, prod
QUARKUS_HTTP_PORT="8080"
QUARKUS_HTTPS_PORT="8443"

# Main class (optional, usually auto-detected)
# APP_MAIN_CLASS="com.company.myapp.Main"

# ============================================
# Database Configuration (Optional)
# ============================================
ENABLE_DATABASE="false"
# DATABASE_TYPE="postgresql"
# DATABASE_HOST="postgres-container"
# DATABASE_PORT="5432"
# DATABASE_NAME="myappdb"
# DATABASE_CREDENTIALS_FILE="/run/secrets/myapp-db-credentials"

# ============================================
# Logging (Inherits Promtail from base)
# ============================================
# Customize log labels for your app
LOG_LABELS="app=myapp,team=backend,env=prod"
LOG_LEVEL="INFO"              # DEBUG, INFO, WARN, ERROR

# ============================================
# Environment Variables
# ============================================
# Comma-separated list of env vars
ENV_VARS="QUARKUS_PROFILE=prod,APP_ENV=production,TZ=UTC"

# ============================================
# Secrets & Config Files
# ============================================
# Mount secrets directory from host
MOUNT_SECRETS="false"
# SECRETS_SOURCE="/home/user/myapp-secrets"
# SECRETS_DEST="/run/secrets"

# Mount application.properties from host
MOUNT_CONFIG="false"
# CONFIG_SOURCE="/home/user/myapp-config/application.properties"
# CONFIG_DEST="/etc/quarkus/application.properties"

# ============================================
# Service Management
# ============================================
ENABLE_SYSTEMD_SERVICE="true"  # Create myapp.service
AUTO_START_ON_BOOT="true"
RESTART_POLICY="on-failure"
RESTART_DELAY="10s"

# ============================================
# Health Checks (Inherits from base)
# ============================================
HEALTH_CHECK_ENABLED="true"
HEALTH_ENDPOINT="/q/health/live"
READINESS_ENDPOINT="/q/health/ready"

# ============================================
# Metrics (Inherits from base)
# ============================================
METRICS_ENABLED="true"
METRICS_ENDPOINT="/q/metrics"
METRICS_PORT="9000"

# ============================================
# Network Port Forwarding
# ============================================
# Ports to expose from container to host
EXPOSE_PORTS="8080,9000"

# ============================================
# Build Options
# ============================================
CLEAN_BUILD="true"             # Remove existing container
EXPORT_CONTAINER="true"        # Export as tarball
EXPORT_PATH="/tmp"
CREATE_SNAPSHOT="true"
START_AFTER_BUILD="true"

# ============================================
# Deployment
# ============================================
# Target environment for this build
DEPLOYMENT_ENV="production"    # development, staging, production

# ============================================
# Versioning & Metadata
# ============================================
BUILD_DATE="$(date +%Y%m%d)"
GIT_COMMIT="$(git rev-parse --short HEAD 2>/dev/null || echo 'unknown')"
GIT_BRANCH="$(git rev-parse --abbrev-ref HEAD 2>/dev/null || echo 'unknown')"
BUILT_BY="$(whoami)"
