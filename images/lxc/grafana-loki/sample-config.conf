# Sample configuration for Grafana-Loki container
# This file demonstrates all available configuration options

# ============================================
# REQUIRED: Container Configuration
# ============================================
container.name=grafana-loki-01
container.version=1.0.0
version.tag=latest
image.path=/tmp/grafana-loki-v1.0.0.tar.gz

# ============================================
# REQUIRED: Storage Configuration (BTRFS)
# ============================================
# Storage provider (currently only btrfs is supported)
storage.provider=btrfs

# Storage location ID (must match system storage configuration)
# Available locations are defined in /etc/orchestrix/storage-locations.conf
# Recommended: btrfs_ssd_main for performance
storage.location.id=btrfs_ssd_main

# Container root directory within storage location
# This will create: <storage_path>/containers/<container_root>
storage.container.root=grafana-loki

# Disk quota for the container (mandatory)
# Recommended: 30G for logs, 50G+ for production
storage.quota.size=30G

# ============================================
# OPTIONAL: Storage Features
# ============================================
# Enable compression (reduces disk usage for logs)
storage.compression=true

# Snapshot configuration
storage.snapshot.enabled=true
storage.snapshot.frequency=daily  # Options: hourly, daily, weekly, monthly
storage.snapshot.retain=7         # Number of snapshots to keep

# ============================================
# Service Versions
# ============================================
# Grafana version
grafana.version=10.2.3

# Loki version
loki.version=2.9.4

# Promtail version
promtail.version=2.9.4

# ============================================
# REQUIRED: Service Ports
# ============================================
# Grafana web interface port
grafana.port=3000

# Loki API port
loki.port=3100

# Promtail metrics port
promtail.port=9080

# ============================================
# OPTIONAL: Container Resources
# ============================================
# Memory limit for the container
memory_limit=2GB

# CPU limit (number of cores)
cpu_limit=2

# ============================================
# OPTIONAL: Bind Mounts
# ============================================
# Format: host_path:container_path,host_path2:container_path2
# Example: External log sources or custom dashboards
# bind_mounts=/data/logs:/external-logs,/data/dashboards:/var/lib/grafana/dashboards
bind_mounts=

# ============================================
# OPTIONAL: Environment Variables
# ============================================
# Format: KEY=value,KEY2=value2
# Example: environment_vars=GF_SECURITY_ADMIN_PASSWORD=secret,GF_INSTALL_PLUGINS=plugin-list
environment_vars=

# ============================================
# Build-specific Configuration (for buildGrafanaLoki.sh)
# ============================================
# Debian version to use as base
debian.version=bookworm

# ============================================
# Log Rotation and Retention Configuration
# ============================================
# Enable log rotation and compaction
log.rotation.enabled=true

# Loki retention period (h=hours, d=days, w=weeks)
# Examples: 168h (7 days), 30d, 4w
loki.retention.period=168h

# Delay before deleting old data
loki.retention.delete.delay=2h

# Enable Loki compactor for automatic cleanup
loki.compactor.enabled=true

# System log rotation (days to keep)
system.log.rotate.days=7

# Compress rotated logs
system.log.compress=true

# Maximum log file size before rotation
loki.max.log.size=100MB

# Specific retention by log level (optional)
# loki.retention.error=90d
# loki.retention.warning=60d
# loki.retention.info=30d
# loki.retention.debug=7d

# ============================================
# Storage Threshold Monitoring
# ============================================
# Enable automatic storage monitoring
storage.monitor.enabled=true

# Trigger rotation when storage reaches this percentage
storage.rotation.threshold=80

# Force aggressive cleanup at this threshold
storage.force.cleanup.threshold=90

# How often to check storage usage (seconds)
storage.check.interval=300

# ============================================
# Network Configuration
# ============================================
# Bridge network for container
network.bridge=lxdbr0

# Static IP (optional, leave empty for DHCP)
network.ip=

# ============================================
# Monitoring Configuration
# ============================================
# Enable metrics endpoint
metrics.enabled=true

# Scrape interval for Promtail
promtail.scrape.interval=10s

# ============================================
# Security Configuration
# ============================================
# Change default Grafana admin password on first login
grafana.force.password.change=true

# Enable HTTPS (requires certificates)
grafana.https.enabled=false

# ============================================
# Notes on Storage Sizing
# ============================================
# Storage requirements depend on:
# - Log volume (GB/day)
# - Retention period (days)
# - Number of log sources
# - Dashboard complexity
#
# Rough estimates:
# - Development: 10-20GB
# - Small production: 30-50GB
# - Medium production: 50-100GB
# - Large production: 100GB+

# ============================================
# Usage Examples
# ============================================
# Build container:
#   ./buildGrafanaLoki.sh sample-config.conf
#
# Launch container from image:
#   ./launchGrafanaLoki.sh sample-config.conf
#
# Quick start with defaults:
#   ./startDefault.sh