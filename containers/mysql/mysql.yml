# MySQL LXD Container Configuration
# Generated by AI Agent for Orchestrix

container:
  name: mysql
  image: ubuntu/22.04
  type: database
  
config:
  # Resource limits
  limits.cpu: "2"
  limits.memory: 4GB
  limits.memory.swap: "false"
  
  # Boot configuration
  boot.autostart: "true"
  boot.autostart.delay: "10"
  boot.autostart.priority: "100"
  
  # Security
  security.nesting: "false"
  security.privileged: "false"

devices:
  root:
    type: disk
    pool: default
    path: /
    size: 20GB
    
  eth0:
    type: nic
    network: lxdbr0
    name: eth0
    
  mysql-data:
    type: disk
    source: /home/telcobright/lxd-data/mysql/data
    path: /var/lib/mysql
    
  mysql-config:
    type: disk
    source: /home/telcobright/lxd-data/mysql/config
    path: /etc/mysql/conf.d

# MySQL specific configuration
mysql:
  version: "8.0"
  root_password: "changeme123"
  port: 3306
  
  # Database to create on init
  databases:
    - orchestrix
    - monitoring
    
  # Users to create
  users:
    - username: orchestrix
      password: "orchpass123"
      host: "%"
      privileges: "ALL"
      database: "orchestrix"
    
    - username: monitoring
      password: "monpass123"
      host: "%"
      privileges: "SELECT"
      database: "*"
  
  # MySQL configuration
  config:
    max_connections: 200
    innodb_buffer_pool_size: "2G"
    query_cache_size: "128M"
    tmp_table_size: "64M"
    max_heap_table_size: "64M"
    
  # Backup settings
  backup:
    enabled: true
    schedule: "0 2 * * *"  # 2 AM daily
    retention_days: 7
    path: /backup/mysql

# Monitoring
monitoring:
  enabled: true
  exporters:
    - mysqld_exporter
  ports:
    mysqld_exporter: 9104

# Network settings
network:
  ip: "10.0.1.10"  # Static IP if needed
  dns:
    - 8.8.8.8
    - 8.8.4.4